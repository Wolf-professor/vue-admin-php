{"remainingRequest":"/Users/quan/code/vue-admin-php/view/node_modules/thread-loader/dist/cjs.js!/Users/quan/code/vue-admin-php/view/node_modules/babel-loader/lib/index.js!/Users/quan/code/vue-admin-php/view/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/quan/code/vue-admin-php/view/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/quan/code/vue-admin-php/view/src/views/adManage/ad.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/quan/code/vue-admin-php/view/src/views/adManage/ad.vue","mtime":1648609501798},{"path":"/Users/quan/code/vue-admin-php/view/babel.config.js","mtime":1648609501757},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/cache-loader/dist/cjs.js","mtime":1614678925383},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/thread-loader/dist/cjs.js","mtime":1614678926780},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/babel-loader/lib/index.js","mtime":1648609858414},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/cache-loader/dist/cjs.js","mtime":1614678925383},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/vue-loader/lib/index.js","mtime":1648609878333}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { adList, adSave, adDelete } from \"../../api/ad/ad\";\nimport Upload from \"../../components/File/Upload.vue\";\nvar formJson = {\n  ad_id: \"\",\n  title: \"\",\n  describe: \"\",\n  pic: \"\",\n  pic_url: \"\",\n  jump_type: \"\",\n  jump_url: \"\",\n  ios_url: \"\",\n  android_url: \"\",\n  wxa_appid: \"\",\n  channel_type: 0,\n  channel_list: [],\n  android_version_type: 0,\n  android_version_list: [],\n  ios_version_type: 0,\n  ios_version_list: [],\n  new_show_start_num: 0,\n  new_show_max_num: 0,\n  old_show_start_num: 0,\n  old_show_max_num: 0,\n  end_time: \"\",\n  event_name: \"\",\n  status: 1\n};\nexport default {\n  data: function data() {\n    return {\n      query: {\n        title: \"\",\n        page: 1,\n        limit: 20\n      },\n      channelListInput: \"\",\n      androidVersionListInput: \"\",\n      iosVersionListInput: \"\",\n      list: [],\n      total: 0,\n      loading: true,\n      index: null,\n      formName: null,\n      formMap: {\n        add: \"新增\",\n        edit: \"编辑\"\n      },\n      formLoading: false,\n      formVisible: false,\n      formData: formJson,\n      formRules: {\n        title: [{\n          required: true,\n          message: \"请输入广告标题\",\n          trigger: \"blur\"\n        }],\n        pic: [{\n          required: true,\n          message: \"请选择封面图片\",\n          trigger: \"change\"\n        }],\n        jump_type: [{\n          required: true,\n          message: \"请选择跳转方式\",\n          trigger: \"change\"\n        }],\n        jump_url: [{\n          required: true,\n          message: \"请输入跳转链接\",\n          trigger: \"blur\"\n        }],\n        android_url: [{\n          required: true,\n          message: \"请输入Android类名\",\n          trigger: \"blur\"\n        }],\n        ios_url: [{\n          required: true,\n          message: \"请输入IOS类名\",\n          trigger: \"blur\"\n        }],\n        wxa_appid: [{\n          required: true,\n          message: \"请输入小程序Appid\",\n          trigger: \"blur\"\n        }],\n        channel_list: [{\n          required: true,\n          message: \"请输入至少一个渠道名单\",\n          trigger: \"change\"\n        }],\n        android_version_list: [{\n          required: true,\n          message: \"请输入至少一个Android版本名单\",\n          trigger: \"change\"\n        }],\n        ios_version_list: [{\n          required: true,\n          message: \"请输入至少一个iOS版本名单\",\n          trigger: \"change\"\n        }],\n        status: [{\n          required: true,\n          message: \"请选择状态\",\n          trigger: \"change\"\n        }]\n      },\n      deleteLoading: false\n    };\n  },\n  components: {\n    Upload: Upload\n  },\n  methods: {\n    onReset: function onReset() {\n      this.$router.push({\n        path: \"\"\n      });\n      this.query = {\n        title: \"\",\n        page: 1,\n        limit: 20\n      };\n      this.getList();\n    },\n    onSubmit: function onSubmit() {\n      this.$router.push({\n        path: \"\",\n        query: this.query\n      });\n      this.getList();\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.query.limit = val;\n      this.getList();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.query.page = val;\n      this.getList();\n    },\n    getList: function getList() {\n      var _this = this;\n\n      this.loading = true;\n      adList(this.query).then(function (response) {\n        _this.loading = false;\n        _this.list = response.data.list || [];\n        _this.total = response.data.total || 0;\n      }).catch(function () {\n        _this.loading = false;\n        _this.list = [];\n        _this.total = 0;\n      });\n    },\n    // 删除渠道\n    handleChannelListClose: function handleChannelListClose(index) {\n      console.log(index); // 更改值\n\n      this.formData.channel_list.splice(index, 1);\n    },\n    // 添加渠道白名单\n    handleChannelListSubmit: function handleChannelListSubmit() {\n      // 更改值\n      if (this.channelListInput && this.formData.channel_list.length < 15) {\n        var arr = this.channelListInput.split(\",\");\n\n        for (var i in arr) {\n          if (arr[i] !== \"\" && (this.formData.channel_list.length === 0 || this.formData.channel_list.indexOf(arr[i]) < 0)) {\n            this.formData.channel_list.push(arr[i]);\n          }\n        }\n\n        this.channelListInput = \"\";\n        this.$refs.channelListRef.focus();\n      }\n    },\n    // 删除Android版本\n    handleAndroidVersionListClose: function handleAndroidVersionListClose(index) {\n      // 更改值\n      this.formData.android_version_list.splice(index, 1);\n    },\n    // 添加Android版本\n    handleAndroidVersionListSubmit: function handleAndroidVersionListSubmit() {\n      // 更改值\n      if (this.androidVersionListInput && this.formData.android_version_list.length < 15) {\n        var arr = this.androidVersionListInput.split(\",\");\n\n        for (var i in arr) {\n          var avList = this.formData.android_version_list;\n\n          if (arr[i] !== \"\" && (avList.length === 0 || avList.indexOf(arr[i]) < 0)) {\n            this.formData.android_version_list.push(arr[i]);\n          }\n        }\n\n        this.androidVersionListInput = \"\";\n        this.$refs.androidVersionListRef.focus();\n      }\n    },\n    // 删除Ios版本\n    handleIosVersionListClose: function handleIosVersionListClose(index) {\n      // 更改值\n      this.formData.ios_version_list.splice(index, 1);\n    },\n    // 添加Ios版本\n    handleIosVersionListSubmit: function handleIosVersionListSubmit() {\n      // 更改值\n      if (this.iosVersionListInput && this.formData.ios_version_list.length < 15) {\n        var arr = this.iosVersionListInput.split(\",\");\n\n        for (var i in arr) {\n          if (arr[i] !== \"\" && (this.formData.ios_version_list.length === 0 || this.formData.ios_version_list.indexOf(arr[i]) < 0)) {\n            this.formData.ios_version_list.push(arr[i]);\n          }\n        }\n\n        this.iosVersionListInput = \"\";\n        this.$refs.iosVersionListRef.focus();\n      }\n    },\n    // 刷新表单\n    resetForm: function resetForm() {\n      if (this.$refs[\"dataForm\"]) {\n        // 清空字段\n        this.$refs[\"dataForm\"].resetFields(); // 清空验证信息表单\n\n        this.$refs[\"dataForm\"].clearValidate();\n      }\n    },\n    // 隐藏表单\n    hideForm: function hideForm() {\n      // 更改值\n      this.formVisible = !this.formVisible;\n      return true;\n    },\n    // 显示表单\n    handleForm: function handleForm(index, row) {\n      this.formVisible = true; // 刷新表单\n\n      this.resetForm();\n      this.formData = JSON.parse(JSON.stringify(formJson));\n\n      if (row !== null) {\n        this.formData = Object.assign({}, row);\n      }\n\n      this.formName = \"add\";\n\n      if (index !== null) {\n        this.index = index;\n        this.formName = \"edit\";\n      }\n    },\n    formSubmit: function formSubmit() {\n      var _this2 = this;\n\n      this.$refs[\"dataForm\"].validate(function (valid) {\n        if (valid) {\n          _this2.formLoading = true;\n          var data = Object.assign({}, _this2.formData);\n          adSave(data, _this2.formName).then(function (response) {\n            _this2.formLoading = false;\n\n            if (response.code) {\n              _this2.$message.error(response.message);\n\n              return false;\n            }\n\n            _this2.$message.success(\"操作成功\");\n\n            _this2.formVisible = false;\n\n            if (_this2.formName === \"add\") {\n              // 向头部添加数据\n              data.ad_id = response.data.ad_id;\n\n              _this2.list.unshift(data);\n            } else {\n              _this2.list.splice(_this2.index, 1, data);\n            }\n          }).catch(function () {\n            _this2.formLoading = false;\n          });\n        }\n      });\n    },\n    // 删除\n    handleDel: function handleDel(index, row) {\n      var _this3 = this;\n\n      if (row.ad_id) {\n        this.$confirm(\"确认删除该记录吗?\", \"提示\", {\n          type: \"warning\"\n        }).then(function () {\n          var para = {\n            ad_id: row.ad_id\n          };\n          _this3.deleteLoading = true;\n          adDelete(para).then(function (response) {\n            _this3.deleteLoading = false;\n\n            if (response.code) {\n              _this3.$message.error(response.message);\n\n              return false;\n            }\n\n            _this3.$message(\"删除成功\"); // 刷新数据\n\n\n            _this3.list.splice(index, 1);\n          }).catch(function () {\n            _this3.deleteLoading = false;\n          });\n        }).catch(function () {\n          _this3.$message.info(\"取消删除\");\n        });\n      }\n    },\n    onSelectPic: function onSelectPic(filePath, filePathUrl) {\n      this.formData.pic = filePath;\n      this.formData.pic_url = filePathUrl;\n    }\n  },\n  filters: {\n    statusFilterType: function statusFilterType(status) {\n      var statusMap = {\n        0: \"gray\",\n        1: \"success\"\n      };\n      return statusMap[status];\n    },\n    statusFilterName: function statusFilterName(status) {\n      var statusMap = {\n        0: \"禁用\",\n        1: \"正常\"\n      };\n      return statusMap[status];\n    }\n  },\n  mounted: function mounted() {},\n  created: function created() {\n    // 将参数拷贝进查询对象\n    var query = this.$route.query;\n    this.query = Object.assign(this.query, query);\n    this.query.limit = parseInt(this.query.limit); // 加载表格数据\n\n    this.getList();\n  }\n};",{"version":3,"mappings":"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ACA,KA7FA;AA8FA;AACAC,6BA/FA,qCA+FAjC,KA/FA,EA+FA;AACA;AACA;AACA,KAlGA;AAmGA;AACAkC,8BApGA,wCAoGA;AACA;AACA,UACA,4BACA,0CAFA,EAGA;AACA;;AACA;AACA,cACAL,kBACA,+CACA,kDAFA,CADA,EAIA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA,KAvHA;AAwHA;AACAM,aAzHA,uBAyHA;AACA;AACA;AACA,6CAFA,CAGA;;AACA;AACA;AACA,KAhIA;AAiIA;AACAC,YAlIA,sBAkIA;AACA;AACA;AACA;AACA,KAtIA;AAuIA;AACAC,cAxIA,sBAwIArC,KAxIA,EAwIAsC,GAxIA,EAwIA;AACA,8BADA,CAEA;;AACA;AACA;;AACA;AACA;AACA;;AACA;;AACA;AACA;AACA;AACA;AACA,KArJA;AAsJAC,cAtJA,wBAsJA;AAAA;;AACA;AACA;AACA;AACA;AACAC,wCACAhB,IADA,CACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;;AACA;;AACA;AACA;AACAlC;;AACA;AACA,aAJA,MAIA;AACA;AACA;AACA,WAhBA,EAiBAmC,KAjBA,CAiBA;AACA;AACA,WAnBA;AAoBA;AACA,OAzBA;AA0BA,KAjLA;AAkLA;AACAgB,aAnLA,qBAmLAzC,KAnLA,EAmLAsC,GAnLA,EAmLA;AAAA;;AACA;AACA;AACAI;AADA,WAGAlB,IAHA,CAGA;AACA;AAAAzD;AAAA;AACA;AACA4E,yBACAnB,IADA,CACA;AACA;;AACA;AACA;;AACA;AACA;;AACA,oCANA,CAOA;;;AACA;AACA,WAVA,EAWAC,KAXA,CAWA;AACA;AACA,WAbA;AAcA,SApBA,EAqBAA,KArBA,CAqBA;AACA;AACA,SAvBA;AAwBA;AACA,KA9MA;AA+MAmB,eA/MA,uBA+MAC,QA/MA,EA+MAC,WA/MA,EA+MA;AACA;AACA;AACA;AAlNA,GAxGA;AA4TAC;AACAC,oBADA,4BACA3D,MADA,EACA;AACA;AACA,iBADA;AAEA;AAFA;AAIA;AACA,KAPA;AAQA4D,oBARA,4BAQA5D,MARA,EAQA;AACA;AACA,eADA;AAEA;AAFA;AAIA;AACA;AAdA,GA5TA;AA4UA6D,SA5UA,qBA4UA,EA5UA;AA6UAC,SA7UA,qBA6UA;AACA;AACA;AACA;AACA,kDAJA,CAKA;;AACA;AACA;AApVA","names":["ad_id","title","describe","pic","pic_url","jump_type","jump_url","ios_url","android_url","wxa_appid","channel_type","channel_list","android_version_type","android_version_list","ios_version_type","ios_version_list","new_show_start_num","new_show_max_num","old_show_start_num","old_show_max_num","end_time","event_name","status","data","query","page","limit","channelListInput","androidVersionListInput","iosVersionListInput","list","total","loading","index","formName","formMap","add","edit","formLoading","formVisible","formData","formRules","required","message","trigger","deleteLoading","components","Upload","methods","onReset","path","onSubmit","handleSizeChange","val","handleCurrentChange","getList","adList","then","catch","handleChannelListClose","console","handleChannelListSubmit","arr","handleAndroidVersionListClose","handleAndroidVersionListSubmit","avList","handleIosVersionListClose","handleIosVersionListSubmit","resetForm","hideForm","handleForm","row","formSubmit","adSave","handleDel","type","adDelete","onSelectPic","filePath","filePathUrl","filters","statusFilterType","statusFilterName","mounted","created"],"sourceRoot":"src/views/adManage","sources":["ad.vue"],"sourcesContent":["<template>\n\n    <div>\n        <el-form :inline=\"true\" :model=\"query\" class=\"query-form\" size=\"mini\">\n            <el-form-item class=\"query-form-item\">\n                <el-input v-model=\"query.title\" placeholder=\"广告标题\"></el-input>\n            </el-form-item>\n            <el-form-item>\n                <el-button-group>\n                    <el-button type=\"primary\" icon=\"el-icon-refresh\" @click=\"getList\"></el-button>\n                    <el-button type=\"primary\" icon=\"search\" @click=\"onSubmit\">查询</el-button>\n                    <el-button type=\"primary\" @click.native=\"handleForm(null,null)\">新增</el-button>\n                </el-button-group>\n            </el-form-item>\n        </el-form>\n        <el-table\n            v-loading=\"loading\"\n            :data=\"list\"\n            style=\"width: 100%;\">\n            <el-table-column\n                label=\"ID\"\n                prop=\"ad_id\"\n                fixed>\n            </el-table-column>\n            <el-table-column\n                label=\"标题\"\n                prop=\"title\"\n                with=\"300\"\n                :show-overflow-tooltip=\"true\"\n                fixed>\n            </el-table-column>\n            <el-table-column\n                label=\"描述\"\n                prop=\"describe\"\n                with=\"300\"\n                :show-overflow-tooltip=\"true\">\n            </el-table-column>\n            <el-table-column\n                label=\"封面\"\n                prop=\"pic_url\">\n                <template slot-scope=\"scope\">\n                    <img style=\"max-width: 200px;max-height: 150px;\" :src=\"scope.row.pic_url\"/>\n                </template>\n            </el-table-column>\n            <el-table-column\n                label=\"状态\">\n                <template slot-scope=\"scope\">\n                    <el-tag :type=\"scope.row.status | statusFilterType\">{{scope.row.status | statusFilterName}}</el-tag>\n                </template>\n            </el-table-column>\n            <el-table-column\n                label=\"操作\"\n                fixed=\"right\">\n                <template slot-scope=\"scope\">\n                    <el-button type=\"text\" size=\"small\" @click.native=\"handleForm(scope.$index, scope.row)\">编辑</el-button>\n                    <el-button type=\"text\" size=\"small\" @click.native=\"handleDel(scope.$index, scope.row)\">删除</el-button>\n                </template>\n            </el-table-column>\n        </el-table>\n\n        <el-pagination\n            :page-size=\"query.limit\"\n            @current-change=\"handleCurrentChange\"\n            layout=\"prev, pager, next\"\n            :total=\"total\">\n        </el-pagination>\n\n        <!--表单-->\n        <el-dialog\n            :title=\"formMap[formName]\"\n            :visible.sync=\"formVisible\"\n            :before-close=\"hideForm\"\n            width=\"85%\"\n            top=\"5vh\">\n            <el-form :model=\"formData\" :rules=\"formRules\" ref=\"dataForm\">\n                <el-form-item label=\"标题\" prop=\"title\">\n                    <el-input v-model=\"formData.title\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"封面图片（上传或填写网络地址）\" prop=\"pic\">\n                    <div>\n                        <el-input size=\"small\" v-model=\"formData.pic\" auto-complete=\"off\" placeholder=\"图片路径\"></el-input>\n\n                        <upload ext=\"jpg,png,jpeg\" :size=\"716800\"  @on-select=\"onSelectPic\"></upload>\n\n                    </div>\n                    <div class=\"upload-img\" v-if=\"formData.pic_url\">\n                        <img :src=\"formData.pic_url\" style=\"max-width: 200px;max-height: 200px;\">\n                    </div>\n\n                </el-form-item>\n                <el-form-item label=\"描述\" prop=\"describe\">\n                    <el-input v-model=\"formData.describe\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"跳转方式\" prop=\"jump_type\">\n                    <el-radio-group v-model=\"formData.jump_type\">\n                        <el-radio :label=\"0\">web 网页</el-radio>\n                        <el-radio :label=\"1\">APP内跳转</el-radio>\n                        <el-radio :label=\"2\">小程序跳转</el-radio>\n                    </el-radio-group>\n                </el-form-item>\n\n                <el-form-item label=\"URL链接（web网页和小程序时）\" prop=\"jump_url\" v-if=\"formData.jump_type === 0 || formData.jump_type === 2\">\n                    <el-input v-model=\"formData.jump_url\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"IOS 类名（APP内跳转时）\" prop=\"ios_url\" v-if=\"formData.jump_type === 1\">\n                    <el-input v-model=\"formData.ios_url\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"Android 类名（APP内跳转时）\" prop=\"android_url\" v-if=\"formData.jump_type === 1\">\n                    <el-input v-model=\"formData.android_url\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"小程序的 appid（小程序跳转时）\" prop=\"wxa_appid\" v-if=\"formData.jump_type === 2\">\n                    <el-input v-model=\"formData.wxa_appid\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"开始时间\">\n\n                    <el-form-item prop=\"start_time\" style=\"display: inline-block;\">\n                        <el-date-picker\n                            v-model=\"formData.start_time\"\n                            type=\"datetime\"\n                            size=\"mini\"\n                            placeholder=\"开始时间（默认不限制）\">\n                        </el-date-picker>\n                    </el-form-item>\n                    -\n                    <el-form-item prop=\"end_time\" style=\"display: inline-block;\">\n                        <el-date-picker\n                            v-model=\"formData.end_time\"\n                            type=\"datetime\"\n                            size=\"mini\"\n                            placeholder=\"结束时间（默认不限制）\">\n                        </el-date-picker>\n                    </el-form-item>\n\n                </el-form-item>\n\n                <el-form-item label=\"统计事件的名称\" prop=\"event_name\">\n                    <el-input v-model=\"formData.event_name\" auto-complete=\"off\"></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"状态\" prop=\"status\">\n                    <el-radio-group v-model=\"formData.status\">\n                        <el-radio :label=\"0\">禁用</el-radio>\n                        <el-radio :label=\"1\">正常</el-radio>\n                    </el-radio-group>\n                </el-form-item>\n\n                <el-form-item>\n                    <el-button style=\"float: right;\" type=\"primary\" @click.native=\"formSubmit()\" :loading=\"formLoading\">提前提交</el-button>\n                </el-form-item>\n\n                <el-form-item label=\"新用户展示逻辑\">\n                    <div class=\"remove-list-box\">\n                        第几次展示\n                        <el-form-item prop=\"new_show_start_num\" style=\"display: inline-block;\">\n                            <el-input-number\n                                v-model=\"formData.new_show_start_num\"\n                                :min=\"0\"\n                                controls-position=\"right\"\n                                size=\"mini\"\n                                label=\"第几次展示\">\n                            </el-input-number>\n                        </el-form-item>\n                        -\n                        展示最大次数\n                        <el-form-item prop=\"new_show_max_num\" style=\"display: inline-block;\">\n                            <el-input-number\n                                v-model=\"formData.new_show_max_num\"\n                                :min=\"0\"\n                                controls-position=\"right\"\n                                size=\"mini\"\n                                label=\"展示最大次数\">\n                            </el-input-number>\n                        </el-form-item>\n                    </div>\n                </el-form-item>\n\n                <el-form-item label=\"老用户展示逻辑\">\n                    <div class=\"remove-list-box\">\n                        第几次展示\n                        <el-form-item prop=\"old_show_start_num\" style=\"display: inline-block;\">\n                            <el-input-number\n                                v-model=\"formData.old_show_start_num\"\n                                :min=\"0\"\n                                controls-position=\"right\"\n                                size=\"mini\"\n                                label=\"第几次展示\">\n                            </el-input-number>\n                        </el-form-item>\n                        -\n                        展示最大次数\n                        <el-form-item prop=\"old_show_max_num\" style=\"display: inline-block;\">\n                            <el-input-number\n                                v-model=\"formData.old_show_max_num\"\n                                :min=\"0\"\n                                controls-position=\"right\"\n                                size=\"mini\"\n                                label=\"展示最大次数\">\n                            </el-input-number>\n                        </el-form-item>\n                    </div>\n                </el-form-item>\n\n                <el-form-item>\n                    <span style='color:red;'>以下内容（注意：不要输入空格和逗号，批量添加以英文逗号隔开）黑白名单用来控制屏蔽或者显示</span>\n                </el-form-item>\n\n                <el-form-item label=\"渠道名单\" required>\n                    <el-form-item prop=\"channel_type\">\n                        <el-radio-group v-model=\"formData.channel_type\">\n                            <el-radio :label=\"0\">不限制</el-radio>\n                            <el-radio :label=\"1\">白名单</el-radio>\n                            <el-radio :label=\"2\">黑名单</el-radio>\n                        </el-radio-group>\n                    </el-form-item>\n                    <el-form-item prop=\"channel_list\" v-if=\"formData.channel_type !== 0\">\n                        <div class=\"remove-list-box\">\n                            <div class=\"remove-list\">\n                                <div class=\"remove-list-item\" v-for=\"(item, index) in formData.channel_list\" :key=\"index\">\n                                    {{item}}\n                                    <i class=\"el-icon-close remove-list-close\" @click=\"handleChannelListClose(index)\"></i>\n                                </div>\n                            </div>\n                            <div v-show=\"formData.channel_list.length >= 15\" style=\"color: red;\">到达最大次数，最大15个</div>\n                            <el-input\n                                size=\"mini\"\n                                v-model=\"channelListInput\"\n                                placeholder=\"输入渠道版本插入\"\n                                style=\"width: 190px;\"\n                                ref=\"channelListRef\"\n                                @keyup.enter.native=\"handleChannelListSubmit\"\n                                maxlength=\"12\">\n                            </el-input>\n                            <el-button type=\"primary\" size=\"mini\" @click.native=\"handleChannelListSubmit()\" style=\"margin-left: 5px;\">插入</el-button>\n                        </div>\n                    </el-form-item>\n                </el-form-item>\n\n                <el-form-item label=\"Android版本名单\" required>\n                    <el-form-item prop=\"android_version_type\">\n                        <el-radio-group v-model=\"formData.android_version_type\">\n                            <el-radio :label=\"0\">不限制</el-radio>\n                            <el-radio :label=\"1\">白名单</el-radio>\n                            <el-radio :label=\"2\">黑名单</el-radio>\n                        </el-radio-group>\n                    </el-form-item>\n                    <el-form-item prop=\"android_version_list\" v-if=\"formData.android_version_type !== 0\">\n                        <div class=\"remove-list-box\">\n                            <div class=\"remove-list\">\n                                <div class=\"remove-list-item\" v-for=\"(item, index) in formData.android_version_list\" :key=\"index\">\n                                    {{item}}\n                                    <i class=\"el-icon-close remove-list-close\" @click=\"handleAndroidVersionListClose(index)\"></i>\n                                </div>\n                            </div>\n                            <div v-show=\"formData.android_version_list.length >= 15\" style=\"color: red;\">到达最大次数，最大15个</div>\n                            <el-input\n                                size=\"mini\"\n                                v-model=\"androidVersionListInput\"\n                                placeholder=\"输入Android版本插入\"\n                                style=\"width: 190px;\"\n                                ref=\"androidVersionListRef\"\n                                @keyup.enter.native=\"handleAndroidVersionListSubmit\"\n                                maxlength=\"12\">\n                            </el-input>\n                            <el-button type=\"primary\" size=\"mini\" @click.native=\"handleAndroidVersionListSubmit()\" style=\"margin-left: 5px;\">插入</el-button>\n                        </div>\n                    </el-form-item>\n                </el-form-item>\n\n                <el-form-item label=\"iOS版本名单\" required>\n                    <el-form-item prop=\"ios_version_type\">\n                        <el-radio-group v-model=\"formData.ios_version_type\">\n                            <el-radio :label=\"0\">不限制</el-radio>\n                            <el-radio :label=\"1\">白名单</el-radio>\n                            <el-radio :label=\"2\">黑名单</el-radio>\n                        </el-radio-group>\n                    </el-form-item>\n                    <el-form-item prop=\"ios_version_list\" v-if=\"formData.ios_version_type !== 0\">\n                        <div class=\"remove-list-box\">\n                            <div class=\"remove-list\">\n                                <div class=\"remove-list-item\" v-for=\"(item, index) in formData.ios_version_list\" :key=\"index\">\n                                    {{item}}\n                                    <i class=\"el-icon-close remove-list-close\" @click=\"handleIosVersionListClose(index)\"></i>\n                                </div>\n                            </div>\n                            <div v-show=\"formData.ios_version_list.length >= 15\" style=\"color: red;\">到达最大次数，最大15个</div>\n                            <el-input\n                                size=\"mini\"\n                                v-model=\"iosVersionListInput\"\n                                placeholder=\"输入iOS版本插入\"\n                                style=\"width: 190px;\"\n                                ref=\"iosVersionListRef\"\n                                @keyup.enter.native=\"handleIosVersionListSubmit\"\n                                maxlength=\"12\">\n                            </el-input>\n                            <el-button type=\"primary\" size=\"mini\" @click.native=\"handleIosVersionListSubmit()\" style=\"margin-left: 5px;\">插入</el-button>\n                        </div>\n                    </el-form-item>\n                </el-form-item>\n\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click.native=\"hideForm\">取消</el-button>\n                <el-button type=\"primary\" @click.native=\"formSubmit()\" :loading=\"formLoading\">提交</el-button>\n            </div>\n        </el-dialog>\n\n    </div>\n\n</template>\n\n<script>\nimport { adList, adSave, adDelete } from \"../../api/ad/ad\";\nimport Upload from \"../../components/File/Upload.vue\";\nconst formJson = {\n    ad_id: \"\",\n    title: \"\",\n    describe: \"\",\n    pic: \"\",\n    pic_url: \"\",\n    jump_type: \"\",\n    jump_url: \"\",\n    ios_url: \"\",\n    android_url: \"\",\n    wxa_appid: \"\",\n    channel_type: 0,\n    channel_list: [],\n    android_version_type: 0,\n    android_version_list: [],\n    ios_version_type: 0,\n    ios_version_list: [],\n    new_show_start_num: 0,\n    new_show_max_num: 0,\n    old_show_start_num: 0,\n    old_show_max_num: 0,\n    end_time: \"\",\n    event_name: \"\",\n    status: 1\n};\nexport default {\n    data() {\n        return {\n            query: {\n                title: \"\",\n                page: 1,\n                limit: 20\n            },\n            channelListInput: \"\",\n            androidVersionListInput: \"\",\n            iosVersionListInput: \"\",\n            list: [],\n            total: 0,\n            loading: true,\n            index: null,\n            formName: null,\n            formMap: {\n                add: \"新增\",\n                edit: \"编辑\"\n            },\n            formLoading: false,\n            formVisible: false,\n            formData: formJson,\n            formRules: {\n                title: [\n                    {\n                        required: true,\n                        message: \"请输入广告标题\",\n                        trigger: \"blur\"\n                    }\n                ],\n                pic: [\n                    {\n                        required: true,\n                        message: \"请选择封面图片\",\n                        trigger: \"change\"\n                    }\n                ],\n                jump_type: [\n                    {\n                        required: true,\n                        message: \"请选择跳转方式\",\n                        trigger: \"change\"\n                    }\n                ],\n                jump_url: [\n                    {\n                        required: true,\n                        message: \"请输入跳转链接\",\n                        trigger: \"blur\"\n                    }\n                ],\n                android_url: [\n                    {\n                        required: true,\n                        message: \"请输入Android类名\",\n                        trigger: \"blur\"\n                    }\n                ],\n                ios_url: [\n                    {\n                        required: true,\n                        message: \"请输入IOS类名\",\n                        trigger: \"blur\"\n                    }\n                ],\n                wxa_appid: [\n                    {\n                        required: true,\n                        message: \"请输入小程序Appid\",\n                        trigger: \"blur\"\n                    }\n                ],\n                channel_list: [\n                    {\n                        required: true,\n                        message: \"请输入至少一个渠道名单\",\n                        trigger: \"change\"\n                    }\n                ],\n                android_version_list: [\n                    {\n                        required: true,\n                        message: \"请输入至少一个Android版本名单\",\n                        trigger: \"change\"\n                    }\n                ],\n                ios_version_list: [\n                    {\n                        required: true,\n                        message: \"请输入至少一个iOS版本名单\",\n                        trigger: \"change\"\n                    }\n                ],\n                status: [\n                    { required: true, message: \"请选择状态\", trigger: \"change\" }\n                ]\n            },\n            deleteLoading: false\n        };\n    },\n    components: {\n        Upload\n    },\n    methods: {\n        onReset() {\n            this.$router.push({\n                path: \"\"\n            });\n            this.query = {\n                title: \"\",\n                page: 1,\n                limit: 20\n            };\n            this.getList();\n        },\n        onSubmit() {\n            this.$router.push({\n                path: \"\",\n                query: this.query\n            });\n            this.getList();\n        },\n        handleSizeChange(val) {\n            this.query.limit = val;\n            this.getList();\n        },\n        handleCurrentChange(val) {\n            this.query.page = val;\n            this.getList();\n        },\n        getList() {\n            this.loading = true;\n            adList(this.query)\n                .then(response => {\n                    this.loading = false;\n                    this.list = response.data.list || [];\n                    this.total = response.data.total || 0;\n                })\n                .catch(() => {\n                    this.loading = false;\n                    this.list = [];\n                    this.total = 0;\n                });\n        },\n        // 删除渠道\n        handleChannelListClose(index) {\n            console.log(index);\n            // 更改值\n            this.formData.channel_list.splice(index, 1);\n        },\n        // 添加渠道白名单\n        handleChannelListSubmit() {\n            // 更改值\n            if (\n                this.channelListInput &&\n                this.formData.channel_list.length < 15\n            ) {\n                let arr = this.channelListInput.split(\",\");\n                for (let i in arr) {\n                    if (\n                        arr[i] !== \"\" &&\n                        (this.formData.channel_list.length === 0 ||\n                            this.formData.channel_list.indexOf(arr[i]) < 0)\n                    ) {\n                        this.formData.channel_list.push(arr[i]);\n                    }\n                }\n                this.channelListInput = \"\";\n                this.$refs.channelListRef.focus();\n            }\n        },\n        // 删除Android版本\n        handleAndroidVersionListClose(index) {\n            // 更改值\n            this.formData.android_version_list.splice(index, 1);\n        },\n        // 添加Android版本\n        handleAndroidVersionListSubmit() {\n            // 更改值\n            if (\n                this.androidVersionListInput &&\n                this.formData.android_version_list.length < 15\n            ) {\n                let arr = this.androidVersionListInput.split(\",\");\n                for (let i in arr) {\n                    let avList = this.formData.android_version_list;\n                    if (\n                        arr[i] !== \"\" &&\n                        (avList.length === 0 || avList.indexOf(arr[i]) < 0)\n                    ) {\n                        this.formData.android_version_list.push(arr[i]);\n                    }\n                }\n                this.androidVersionListInput = \"\";\n                this.$refs.androidVersionListRef.focus();\n            }\n        },\n        // 删除Ios版本\n        handleIosVersionListClose(index) {\n            // 更改值\n            this.formData.ios_version_list.splice(index, 1);\n        },\n        // 添加Ios版本\n        handleIosVersionListSubmit() {\n            // 更改值\n            if (\n                this.iosVersionListInput &&\n                this.formData.ios_version_list.length < 15\n            ) {\n                let arr = this.iosVersionListInput.split(\",\");\n                for (let i in arr) {\n                    if (\n                        arr[i] !== \"\" &&\n                        (this.formData.ios_version_list.length === 0 ||\n                            this.formData.ios_version_list.indexOf(arr[i]) < 0)\n                    ) {\n                        this.formData.ios_version_list.push(arr[i]);\n                    }\n                }\n                this.iosVersionListInput = \"\";\n                this.$refs.iosVersionListRef.focus();\n            }\n        },\n        // 刷新表单\n        resetForm() {\n            if (this.$refs[\"dataForm\"]) {\n                // 清空字段\n                this.$refs[\"dataForm\"].resetFields();\n                // 清空验证信息表单\n                this.$refs[\"dataForm\"].clearValidate();\n            }\n        },\n        // 隐藏表单\n        hideForm() {\n            // 更改值\n            this.formVisible = !this.formVisible;\n            return true;\n        },\n        // 显示表单\n        handleForm(index, row) {\n            this.formVisible = true;\n            // 刷新表单\n            this.resetForm();\n            this.formData = JSON.parse(JSON.stringify(formJson));\n            if (row !== null) {\n                this.formData = Object.assign({}, row);\n            }\n            this.formName = \"add\";\n            if (index !== null) {\n                this.index = index;\n                this.formName = \"edit\";\n            }\n        },\n        formSubmit() {\n            this.$refs[\"dataForm\"].validate(valid => {\n                if (valid) {\n                    this.formLoading = true;\n                    let data = Object.assign({}, this.formData);\n                    adSave(data, this.formName)\n                        .then(response => {\n                            this.formLoading = false;\n                            if (response.code) {\n                                this.$message.error(response.message);\n                                return false;\n                            }\n                            this.$message.success(\"操作成功\");\n                            this.formVisible = false;\n                            if (this.formName === \"add\") {\n                                // 向头部添加数据\n                                data.ad_id = response.data.ad_id;\n                                this.list.unshift(data);\n                            } else {\n                                this.list.splice(this.index, 1, data);\n                            }\n                        })\n                        .catch(() => {\n                            this.formLoading = false;\n                        });\n                }\n            });\n        },\n        // 删除\n        handleDel(index, row) {\n            if (row.ad_id) {\n                this.$confirm(\"确认删除该记录吗?\", \"提示\", {\n                    type: \"warning\"\n                })\n                    .then(() => {\n                        let para = { ad_id: row.ad_id };\n                        this.deleteLoading = true;\n                        adDelete(para)\n                            .then(response => {\n                                this.deleteLoading = false;\n                                if (response.code) {\n                                    this.$message.error(response.message);\n                                    return false;\n                                }\n                                this.$message(\"删除成功\");\n                                // 刷新数据\n                                this.list.splice(index, 1);\n                            })\n                            .catch(() => {\n                                this.deleteLoading = false;\n                            });\n                    })\n                    .catch(() => {\n                        this.$message.info(\"取消删除\");\n                    });\n            }\n        },\n        onSelectPic(filePath, filePathUrl) {\n            this.formData.pic = filePath;\n            this.formData.pic_url = filePathUrl;\n        }\n    },\n    filters: {\n        statusFilterType(status) {\n            const statusMap = {\n                0: \"gray\",\n                1: \"success\"\n            };\n            return statusMap[status];\n        },\n        statusFilterName(status) {\n            const statusMap = {\n                0: \"禁用\",\n                1: \"正常\"\n            };\n            return statusMap[status];\n        }\n    },\n    mounted() {},\n    created() {\n        // 将参数拷贝进查询对象\n        let query = this.$route.query;\n        this.query = Object.assign(this.query, query);\n        this.query.limit = parseInt(this.query.limit);\n        // 加载表格数据\n        this.getList();\n    }\n};\n</script>\n\n<style type=\"text/scss\" lang=\"scss\">\n</style>\n"]}]}