{"remainingRequest":"/Users/quan/code/vue-admin-php/view/node_modules/thread-loader/dist/cjs.js!/Users/quan/code/vue-admin-php/view/node_modules/babel-loader/lib/index.js!/Users/quan/code/vue-admin-php/view/node_modules/eslint-loader/index.js??ref--13-0!/Users/quan/code/vue-admin-php/view/src/store/modules/admin.js","dependencies":[{"path":"/Users/quan/code/vue-admin-php/view/src/store/modules/admin.js","mtime":1648609501794},{"path":"/Users/quan/code/vue-admin-php/view/babel.config.js","mtime":1648609501757},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/cache-loader/dist/cjs.js","mtime":1614678925383},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/thread-loader/dist/cjs.js","mtime":1614678926780},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/babel-loader/lib/index.js","mtime":1648609858414},{"path":"/Users/quan/code/vue-admin-php/view/node_modules/eslint-loader/index.js","mtime":1614678921459}],"contextDependencies":[],"result":["import _defineProperty from \"/Users/quan/code/vue-admin-php/view/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js\";\n\nvar _mutations;\n\nimport { userInfo as _userInfo, loginName as _loginName, logout } from \"../../api/auth/login\";\nimport * as types from \"../mutation-types\";\nimport { constantRouterMap } from \"../../router\";\nimport { getToken, setToken, removeToken, getAdminId, setAdminId, removeAdminId } from \"../../utils/auth\"; // import { $NOT_NETWORK } from '../../utils/errorCode'\n\nimport { Message } from \"element-ui\"; // initial state\n\nvar state = {\n  adminId: getAdminId(),\n  // id\n  userName: \"\",\n  // 昵称\n  avatar: \"\",\n  // 头像\n  token: getToken(),\n  // 登录token\n  authRules: [],\n  // 权限列表\n  routers: constantRouterMap // 路由列表\n\n}; // getters\n\nvar getters = {\n  adminId: function adminId(state) {\n    return state.adminId;\n  },\n  userName: function userName(state) {\n    return state.userName;\n  },\n  avatar: function avatar(state) {\n    return state.avatar;\n  },\n  token: function token(state) {\n    return state.token;\n  },\n  authRules: function authRules(state) {\n    return state.authRules;\n  },\n  routers: function routers(state) {\n    return state.routers;\n  }\n}; // actions\n\nvar actions = {\n  // 用户名登录\n  loginName: function loginName(_ref, userInfo) {\n    var commit = _ref.commit;\n    var userName = userInfo.userName ? userInfo.userName.trim() : \"\";\n    var pwd = userInfo.pwd ? userInfo.pwd : \"\";\n    return new Promise(function (resolve, reject) {\n      _loginName(userName, pwd).then(function (response) {\n        if (response.code) {\n          Message({\n            message: response.message,\n            type: \"error\",\n            duration: 5 * 1000\n          });\n        } else {\n          var data = response.data;\n          commit(types.RECEIVE_ADMIN_ID, data.id);\n          commit(types.RECEIVE_ADMIN_TOKEN, data.token);\n          commit(types.RECEIVE_ADMIN_AUTH_RULES, []);\n        }\n\n        resolve(response);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  userInfo: function userInfo(_ref2) {\n    var commit = _ref2.commit;\n    return new Promise(function (resolve, reject) {\n      _userInfo().then(function (response) {\n        if (response.code === 2) {\n          reject(\"登录失效\");\n        }\n\n        var data = response.data || {};\n        commit(types.RECEIVE_ADMIN_NAME, data.username);\n        commit(types.RECEIVE_ADMIN_AVATAR, data.avatar);\n        commit(types.RECEIVE_ADMIN_AUTH_RULES, data.authRules);\n        resolve(data);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // 登出\n  loginOut: function loginOut(_ref3) {\n    var commit = _ref3.commit;\n    return new Promise(function (resolve, reject) {\n      logout().then(function () {\n        commit(types.RECEIVE_ADMIN_ID, \"\");\n        commit(types.RECEIVE_ADMIN_TOKEN, \"\");\n        commit(types.RECEIVE_ADMIN_AUTH_RULES, []);\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // 前端 登出\n  fedLogout: function fedLogout(_ref4) {\n    var commit = _ref4.commit;\n    return new Promise(function (resolve) {\n      commit(types.RECEIVE_ADMIN_ID, \"\");\n      commit(types.RECEIVE_ADMIN_TOKEN, \"\");\n      commit(types.RECEIVE_ADMIN_AUTH_RULES, []);\n      resolve();\n    });\n  },\n\n  /**\n   * 过滤路由列表\n   * @param commit\n   * @param data\n   * @returns {Promise}\n   */\n  filterRouter: function filterRouter(_ref5, data) {\n    var commit = _ref5.commit;\n    var accessedRouters = data.accessedRouters;\n\n    if (accessedRouters && accessedRouters.length > 0) {\n      commit(types.RECEIVE_ROUTERS, accessedRouters);\n    }\n  }\n}; // mutations\n\nvar mutations = (_mutations = {}, _defineProperty(_mutations, types.RECEIVE_ADMIN_ID, function (state, adminId) {\n  state.adminId = adminId;\n\n  if (adminId === \"\") {\n    removeAdminId();\n  } else {\n    setAdminId(adminId);\n  }\n}), _defineProperty(_mutations, types.RECEIVE_ADMIN_TOKEN, function (state, token) {\n  state.token = token;\n\n  if (token === \"\") {\n    removeToken();\n  } else {\n    setToken(token);\n  }\n}), _defineProperty(_mutations, types.RECEIVE_ADMIN_NAME, function (state, userName) {\n  state.userName = userName;\n}), _defineProperty(_mutations, types.RECEIVE_ADMIN_AVATAR, function (state, avatar) {\n  state.avatar = avatar;\n}), _defineProperty(_mutations, types.RECEIVE_ADMIN_AUTH_RULES, function (state, authRules) {\n  state.authRules = authRules;\n}), _defineProperty(_mutations, types.RECEIVE_ROUTERS, function (state, routers) {\n  var tempRm = constantRouterMap.concat(routers);\n  state.routers = JSON.parse(JSON.stringify(tempRm));\n}), _mutations);\nexport default {\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};",{"version":3,"sources":["/Users/quan/code/vue-admin-php/view/src/store/modules/admin.js"],"names":["userInfo","loginName","logout","types","constantRouterMap","getToken","setToken","removeToken","getAdminId","setAdminId","removeAdminId","Message","state","adminId","userName","avatar","token","authRules","routers","getters","actions","commit","trim","pwd","Promise","resolve","reject","then","response","code","message","type","duration","data","RECEIVE_ADMIN_ID","id","RECEIVE_ADMIN_TOKEN","RECEIVE_ADMIN_AUTH_RULES","catch","error","RECEIVE_ADMIN_NAME","username","RECEIVE_ADMIN_AVATAR","loginOut","fedLogout","filterRouter","accessedRouters","length","RECEIVE_ROUTERS","mutations","tempRm","concat","JSON","parse","stringify"],"mappings":"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","sourcesContent":["import { userInfo, loginName, logout } from \"../../api/auth/login\";\nimport * as types from \"../mutation-types\";\nimport { constantRouterMap } from \"../../router\";\nimport {\n    getToken,\n    setToken,\n    removeToken,\n    getAdminId,\n    setAdminId,\n    removeAdminId\n} from \"../../utils/auth\";\n// import { $NOT_NETWORK } from '../../utils/errorCode'\nimport { Message } from \"element-ui\";\n\n// initial state\nconst state = {\n    adminId: getAdminId(), // id\n    userName: \"\", // 昵称\n    avatar: \"\", // 头像\n    token: getToken(), // 登录token\n    authRules: [], // 权限列表\n    routers: constantRouterMap // 路由列表\n};\n\n// getters\nconst getters = {\n    adminId: state => state.adminId,\n    userName: state => state.userName,\n    avatar: state => state.avatar,\n    token: state => state.token,\n    authRules: state => state.authRules,\n    routers: state => state.routers\n};\n\n// actions\nconst actions = {\n    // 用户名登录\n    loginName({ commit }, userInfo) {\n        const userName = userInfo.userName ? userInfo.userName.trim() : \"\";\n        const pwd = userInfo.pwd ? userInfo.pwd : \"\";\n        return new Promise((resolve, reject) => {\n            loginName(userName, pwd)\n                .then(response => {\n                    if (response.code) {\n                        Message({\n                            message: response.message,\n                            type: \"error\",\n                            duration: 5 * 1000\n                        });\n                    } else {\n                        let data = response.data;\n                        commit(types.RECEIVE_ADMIN_ID, data.id);\n                        commit(types.RECEIVE_ADMIN_TOKEN, data.token);\n                        commit(types.RECEIVE_ADMIN_AUTH_RULES, []);\n                    }\n                    resolve(response);\n                })\n                .catch(error => {\n                    reject(error);\n                });\n        });\n    },\n    userInfo({ commit }) {\n        return new Promise((resolve, reject) => {\n            userInfo()\n                .then(response => {\n                    if (response.code === 2) {\n                        reject(\"登录失效\");\n                    }\n                    const data = response.data || {};\n                    commit(types.RECEIVE_ADMIN_NAME, data.username);\n                    commit(types.RECEIVE_ADMIN_AVATAR, data.avatar);\n                    commit(types.RECEIVE_ADMIN_AUTH_RULES, data.authRules);\n                    resolve(data);\n                })\n                .catch(error => {\n                    reject(error);\n                });\n        });\n    },\n    // 登出\n    loginOut({ commit }) {\n        return new Promise((resolve, reject) => {\n            logout()\n                .then(() => {\n                    commit(types.RECEIVE_ADMIN_ID, \"\");\n                    commit(types.RECEIVE_ADMIN_TOKEN, \"\");\n                    commit(types.RECEIVE_ADMIN_AUTH_RULES, []);\n                    resolve();\n                })\n                .catch(error => {\n                    reject(error);\n                });\n        });\n    },\n\n    // 前端 登出\n    fedLogout({ commit }) {\n        return new Promise(resolve => {\n            commit(types.RECEIVE_ADMIN_ID, \"\");\n            commit(types.RECEIVE_ADMIN_TOKEN, \"\");\n            commit(types.RECEIVE_ADMIN_AUTH_RULES, []);\n            resolve();\n        });\n    },\n    /**\n     * 过滤路由列表\n     * @param commit\n     * @param data\n     * @returns {Promise}\n     */\n    filterRouter({ commit }, data) {\n        const { accessedRouters } = data;\n        if (accessedRouters && accessedRouters.length > 0) {\n            commit(types.RECEIVE_ROUTERS, accessedRouters);\n        }\n    }\n};\n\n// mutations\nconst mutations = {\n    [types.RECEIVE_ADMIN_ID](state, adminId) {\n        state.adminId = adminId;\n        if (adminId === \"\") {\n            removeAdminId();\n        } else {\n            setAdminId(adminId);\n        }\n    },\n    [types.RECEIVE_ADMIN_TOKEN](state, token) {\n        state.token = token;\n        if (token === \"\") {\n            removeToken();\n        } else {\n            setToken(token);\n        }\n    },\n    [types.RECEIVE_ADMIN_NAME](state, userName) {\n        state.userName = userName;\n    },\n    [types.RECEIVE_ADMIN_AVATAR](state, avatar) {\n        state.avatar = avatar;\n    },\n    [types.RECEIVE_ADMIN_AUTH_RULES](state, authRules) {\n        state.authRules = authRules;\n    },\n    [types.RECEIVE_ROUTERS](state, routers) {\n        const tempRm = constantRouterMap.concat(routers);\n        state.routers = JSON.parse(JSON.stringify(tempRm));\n    }\n};\n\nexport default {\n    state,\n    getters,\n    actions,\n    mutations\n};\n"]}]}